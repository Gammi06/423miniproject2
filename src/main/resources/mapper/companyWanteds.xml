<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="site.metacoding.miniproject2.domain.wanteds.WantedsDao">

	<select id="findAllWanteds" resultType="site.metacoding.miniproject2.web.dto.response.wanteds.WantedsManageDto">
		SELECT w.company_id, w.id, w.title, w.detail, w.position_code_id, w.career_code_id, p.name positionName, c.name careerName, if(w.enddate > NOW(), '채용중', '마감') state
		FROM wanteds w
		LEFT OUTER JOIN positions_code p
		ON p.id = w.position_code_id
		LEFT OUTER JOIN careers_code c
		ON c.id = w.career_code_id
		WHERE w.company_id = #{companyId}
	</select>

	<select id="findAllByCareer" resultType="site.metacoding.miniproject2.web.dto.response.wanteds.WantedsManageDto">
		SELECT w.company_id, w.id, w.title, w.detail, w.career_code_id, c.name, if(w.enddate > NOW(), '채용중', '마감') state
		FROM wanteds w
		INNER JOIN careers_code c
		ON c.id = w.career_code_id
		WHERE w.company_id = #{companyId}
		AND w.career_code_id = #{careerCodeId}
	</select>

	<select id="findAllByPositionToCompany" resultType="site.metacoding.miniproject2.web.dto.response.wanteds.WantedsManageDto">
		SELECT w.company_id, w.id, w.title, w.detail, w.position_code_id , p.name, if(w.enddate > NOW(), '모집중', '마감') state
		FROM wanteds w
		INNER JOIN positions_code p
		ON p.id = w.position_code_id
		WHERE w.company_id = #{companyId}
		AND w.position_code_id = #{positionCodeId}
	</select>

	<select id="findByBoth" resultType="site.metacoding.miniproject2.web.dto.response.wanteds.WantedsManageDto">
		SELECT w.company_id, w.id, w.title, w.detail, w.position_code_id, w.career_code_id, c.name, p.name, if(w.enddate > NOW(), '모집중', '마감') state
		FROM wanteds w
		LEFT OUTER JOIN positions_code p
		ON p.id = w.position_code_id
		LEFT OUTER JOIN careers_code c
		ON c.id = w.career_code_id
		WHERE w.company_id = #{companyId}
		AND w.position_code_id = #{positionCodeId}
		AND w.career_code_id = #{careerCodeId}
	</select>

</mapper>